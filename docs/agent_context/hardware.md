# 硬件平台说明

本文档详细说明 AI Assistant 项目使用的硬件平台。AI Agent 在需要了解硬件能力或进行固件开发时应阅读此文档。

---

## 硬件平台：立创·实战派 ESP32-S3

### 开源资料

| 资源 | 链接 |
|------|------|
| **开源硬件** | https://oshwhub.com/li-chuang-kai-fa-ban/li-chuang-shi-zhan-pai-esp32-s3-kai-fa-ban |
| **官方 Wiki** | https://wiki.lckfb.com/zh-hans/szpi-esp32s3/ |
| **购买链接** | https://item.szlcsc.com/43285221.html |

---

## 核心规格

### 主控模组

| 项目 | 规格 |
|------|------|
| **型号** | ESP32-S3-WROOM-1-N16R8 |
| **处理器** | Xtensa® 32位 LX7 双核 |
| **主频** | 240 MHz |
| **内置 SRAM** | 512 KB |
| **外置 PSRAM** | 8 MB |
| **外置 Flash** | 16 MB |
| **Wi-Fi** | 2.4 GHz 802.11 b/g/n, 40MHz 带宽 |
| **蓝牙** | Bluetooth 5 (LE) + Mesh |
| **AI 加速** | 集成 AI 向量指令，加速神经网络计算 |

### 显示系统

| 组件 | 型号 | 规格 |
|------|------|------|
| **显示屏** | ST7789 | 2.0寸 IPS, 320×240, SPI 接口 |
| **触摸屏** | FT6336 | 电容触摸, I2C 接口 |

### 音频系统

| 组件 | 型号 | 规格 |
|------|------|------|
| **音频 DAC** | ES8311 | 单通道, I2C 接口 |
| **音频 ADC** | ES7210 | 四通道 (用3通道), I2C 接口 |
| **功放芯片** | NS4150B | 单声道 D 类放大器 |
| **麦克风** | ZTS6216 ×2 | 双路模拟麦克风 |
| **喇叭** | DB1811AB50 | 1811 音腔, 1W |

### 传感器

| 组件 | 型号 | 规格 |
|------|------|------|
| **姿态传感器** | QMI8658 | 三轴加速度 + 三轴陀螺仪, I2C |

### 存储与接口

| 组件 | 型号 | 规格 |
|------|------|------|
| **USB HUB** | CH334F | USB 2.0 HUB |
| **USB 转串口** | CH340K | 波特率最大 2Mbps |
| **电源芯片** | SY8088AAC | 双路, 每路 1A |
| **TF 卡** | - | 1-SD 模式 |
| **扩展接口** | GH1.25 ×2 | GPIO/CAN/I2C/UART/PWM |

---

## 引脚分配

### I2C 总线

| 设备 | 地址 | 用途 |
|------|------|------|
| FT6336 | 0x38 | 触摸屏 |
| ES8311 | 0x18 | 音频 DAC |
| ES7210 | 0x40 | 音频 ADC |
| QMI8658 | 0x6B | 姿态传感器 |

### SPI 总线

| 设备 | 用途 |
|------|------|
| ST7789 | 显示屏 |
| TF 卡 | 存储 |

### I2S 音频

| 信号 | 用途 |
|------|------|
| BCLK | 位时钟 |
| WS | 字选择 (左/右声道) |
| DOUT | 数据输出 (DAC) |
| DIN | 数据输入 (ADC) |

---

## 功能能力

### 可实现功能

- ✅ 语音采集 (双麦克风)
- ✅ 语音播放 (喇叭)
- ✅ 彩色显示 (2寸 IPS)
- ✅ 触摸交互
- ✅ Wi-Fi 联网
- ✅ 蓝牙通信
- ✅ 姿态检测
- ✅ AI 图像识别 (摄像头接口)
- ✅ AI 语音识别 (云端)
- ✅ TF 卡存储
- ✅ USB 通信

### 性能限制

| 限制 | 说明 |
|------|------|
| **音频采样** | 16kHz 推荐 (Opus 编码) |
| **显示刷新** | SPI 带宽限制, 适合 UI 而非视频 |
| **内存** | 8MB PSRAM, 复杂 AI 模型需云端 |
| **功耗** | USB 供电, 移动场景需外接电池 |

---

## 固件开发

### 开发环境

- **框架**: ESP-IDF 5.4+
- **IDE**: VSCode + ESP-IDF 插件
- **参考固件**: `SDK/xiaozhi-esp32/`

### 编译命令

```bash
# 配置目标芯片
idf.py set-target esp32s3

# 配置项目
idf.py menuconfig

# 编译
idf.py build

# 烧录
idf.py flash

# 监控串口
idf.py monitor
```

### 分区表

参考 `SDK/xiaozhi-esp32/partitions/` 目录的分区配置。

---

## 注意事项

### 硬件调试

1. **USB 识别问题**: 确保安装 CH340 驱动
2. **声音过小**: 检查 NS4150B 功放焊接
3. **屏幕不显示**: 检查 SPI 连接和 ST7789 初始化

### 固件烧录

1. 按住 BOOT 键
2. 按一下 RST 键
3. 松开 BOOT 键
4. 执行 `idf.py flash`

---

## 相关文档

| 文档 | 路径 |
|------|------|
| 固件源码 | `SDK/xiaozhi-esp32/` |
| 通信协议 | `docs/agent_context/protocols.md` |
| 系统架构 | `docs/agent_context/architecture.md` |
